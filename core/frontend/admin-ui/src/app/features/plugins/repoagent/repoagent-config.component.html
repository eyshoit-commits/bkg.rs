<div class="space-y-6">
  <div class="rounded-xl border border-slate-800/80 bg-slate-950/70 p-4">
    <h4 class="text-sm font-semibold uppercase tracking-wide text-slate-300">Arbeitsverzeichnis</h4>
    <div class="mt-3 grid gap-4 md:grid-cols-2">
      <label class="space-y-1 text-xs text-slate-400">
        <span class="block font-medium text-slate-200">Default Root</span>
        <input
          type="text"
          [ngModel]="settings.defaultRoot"
          (ngModelChange)="onDefaultRootChange($event)"
          class="w-full rounded-lg border border-slate-800 bg-black/40 px-3 py-2 text-sm text-slate-100 focus:border-primary focus:outline-none"
        />
      </label>
      <label class="space-y-1 text-xs text-slate-400">
        <span class="block font-medium text-slate-200">Max. Dateien für Scans</span>
        <input
          type="number"
          min="1"
          [ngModel]="settings.maxFiles"
          (ngModelChange)="onMaxFilesChange($event)"
          class="w-full rounded-lg border border-slate-800 bg-black/40 px-3 py-2 text-sm text-slate-100 focus:border-primary focus:outline-none"
        />
      </label>
    </div>
    <div class="mt-4 flex flex-wrap items-center gap-3 text-xs text-slate-400">
      <span class="font-medium text-slate-200">Git-Unterstützung</span>
      <label class="inline-flex cursor-pointer items-center gap-2">
        <input type="checkbox" [checked]="settings.enableGit" (change)="toggleGit($event.target.checked)" />
        <span>Aktiviert</span>
      </label>
      <label class="space-x-2">
        <span class="font-medium text-slate-200">Telemetry Intervall (s)</span>
        <input
          type="number"
          min="5"
          [ngModel]="settings.telemetry.sampleIntervalSeconds"
          (ngModelChange)="onTelemetryIntervalChange($event)"
          class="w-24 rounded-lg border border-slate-800 bg-black/40 px-3 py-1 text-sm text-slate-100 focus:border-primary focus:outline-none"
        />
      </label>
    </div>
  </div>

  <div class="rounded-xl border border-slate-800/80 bg-slate-950/70 p-4">
    <div class="flex items-center justify-between">
      <h4 class="text-sm font-semibold uppercase tracking-wide text-slate-300">Workspace Roots</h4>
      <button class="rounded bg-primary px-3 py-1 text-xs font-semibold text-white hover:bg-primary/80" (click)="addWorkspaceRoot()">
        Hinzufügen
      </button>
    </div>
    <div class="mt-3 space-y-3">
      <div *ngFor="let root of settings.workspaceRoots; let i = index; trackBy: trackByIndex" class="flex items-center gap-2">
        <input
          type="text"
          [ngModel]="root"
          (ngModelChange)="onWorkspaceRootChange(i, $event)"
          class="flex-1 rounded-lg border border-slate-800 bg-black/40 px-3 py-2 text-sm text-slate-100 focus:border-primary focus:outline-none"
        />
        <button class="rounded border border-slate-700 px-2 py-1 text-xs text-slate-300 hover:bg-slate-800" (click)="removeWorkspaceRoot(i)">
          Entfernen
        </button>
      </div>
      <p *ngIf="settings.workspaceRoots.length === 0" class="text-xs text-slate-500">Noch keine zusätzlichen Roots definiert.</p>
    </div>
  </div>

  <div class="rounded-xl border border-slate-800/80 bg-slate-950/70 p-4">
    <div class="flex items-center justify-between">
      <h4 class="text-sm font-semibold uppercase tracking-wide text-slate-300">Ignore Patterns</h4>
      <button class="rounded bg-primary px-3 py-1 text-xs font-semibold text-white hover:bg-primary/80" (click)="addIgnoreGlob()">
        Hinzufügen
      </button>
    </div>
    <div class="mt-3 space-y-3">
      <div *ngFor="let pattern of settings.ignoreGlobs; let i = index; trackBy: trackByIndex" class="flex items-center gap-2">
        <input
          type="text"
          [ngModel]="pattern"
          (ngModelChange)="onIgnoreGlobChange(i, $event)"
          class="flex-1 rounded-lg border border-slate-800 bg-black/40 px-3 py-2 text-sm text-slate-100 focus:border-primary focus:outline-none"
        />
        <button class="rounded border border-slate-700 px-2 py-1 text-xs text-slate-300 hover:bg-slate-800" (click)="removeIgnoreGlob(i)">
          Entfernen
        </button>
      </div>
      <p *ngIf="settings.ignoreGlobs.length === 0" class="text-xs text-slate-500">Keine Ignore-Globs konfiguriert.</p>
    </div>
  </div>

  <div class="rounded-xl border border-slate-800/80 bg-slate-950/70 p-4">
    <div class="flex items-center justify-between">
      <h4 class="text-sm font-semibold uppercase tracking-wide text-slate-300">Command Allowlist</h4>
      <button class="rounded bg-primary px-3 py-1 text-xs font-semibold text-white hover:bg-primary/80" (click)="addCommand()">
        Neuer Befehl
      </button>
    </div>
    <div class="mt-3 space-y-4">
      <div *ngFor="let command of settings.commandAllowlist; let i = index; trackBy: trackCommand" class="space-y-3 rounded-lg border border-slate-800/70 bg-black/30 p-4">
        <div class="grid gap-3 md:grid-cols-2">
          <label class="space-y-1 text-xs text-slate-400">
            <span class="block font-medium text-slate-200">Name</span>
            <input
              type="text"
              [ngModel]="command.name"
              (ngModelChange)="onCommandNameChange(i, $event)"
              class="w-full rounded-lg border border-slate-800 bg-black/40 px-3 py-2 text-sm text-slate-100 focus:border-primary focus:outline-none"
            />
          </label>
          <label class="space-y-1 text-xs text-slate-400">
            <span class="block font-medium text-slate-200">Timeout (Sekunden)</span>
            <input
              type="number"
              min="1"
              [ngModel]="command.timeoutSeconds"
              (ngModelChange)="onCommandTimeoutChange(i, $event)"
              class="w-full rounded-lg border border-slate-800 bg-black/40 px-3 py-2 text-sm text-slate-100 focus:border-primary focus:outline-none"
            />
          </label>
        </div>
        <label class="block space-y-1 text-xs text-slate-400">
          <span class="block font-medium text-slate-200">Ausführungsbefehl</span>
          <input
            type="text"
            [ngModel]="command.executable.join(' ')"
            (ngModelChange)="onCommandExecutableChange(i, $event)"
            class="w-full rounded-lg border border-slate-800 bg-black/40 px-3 py-2 text-sm text-slate-100 focus:border-primary focus:outline-none"
          />
        </label>
        <div class="flex flex-wrap items-center gap-3 text-xs text-slate-400">
          <label class="inline-flex cursor-pointer items-center gap-2">
            <input type="checkbox" [checked]="command.allowArgs" (change)="onCommandAllowArgsChange(i, $event.target.checked)" />
            <span>Zusätzliche Argumente erlauben</span>
          </label>
          <label class="space-x-2">
            <span class="font-medium text-slate-200">Arbeitsverzeichnis</span>
            <input
              type="text"
              [ngModel]="command.workingDir || ''"
              (ngModelChange)="onCommandWorkingDirChange(i, $event)"
              class="w-52 rounded-lg border border-slate-800 bg-black/40 px-3 py-1 text-sm text-slate-100 focus:border-primary focus:outline-none"
            />
          </label>
          <button class="rounded border border-rose-700 px-3 py-1 text-xs font-semibold text-rose-300 hover:bg-rose-900/40" (click)="removeCommand(i)">
            Befehl löschen
          </button>
        </div>
      </div>
      <p *ngIf="settings.commandAllowlist.length === 0" class="text-xs text-slate-500">Noch keine Befehle definiert.</p>
    </div>
  </div>

  <div class="rounded-xl border border-slate-800/80 bg-slate-950/70 p-4">
    <div class="flex items-center justify-between">
      <h4 class="text-sm font-semibold uppercase tracking-wide text-slate-300">Environment Overrides</h4>
      <button class="rounded bg-primary px-3 py-1 text-xs font-semibold text-white hover:bg-primary/80" (click)="addEnvironmentEntry()">
        Variable hinzufügen
      </button>
    </div>
    <div class="mt-3 space-y-3">
      <div *ngFor="let entry of environmentEntries(); let i = index; trackBy: trackByIndex" class="grid gap-2 md:grid-cols-[1fr_1fr_auto]">
        <input
          type="text"
          [ngModel]="entry.key"
          (ngModelChange)="onEnvironmentKeyChange(i, $event)"
          placeholder="Schlüssel"
          class="rounded-lg border border-slate-800 bg-black/40 px-3 py-2 text-sm text-slate-100 focus:border-primary focus:outline-none"
        />
        <input
          type="text"
          [ngModel]="entry.value"
          (ngModelChange)="onEnvironmentValueChange(i, $event)"
          placeholder="Wert"
          class="rounded-lg border border-slate-800 bg-black/40 px-3 py-2 text-sm text-slate-100 focus:border-primary focus:outline-none"
        />
        <button class="rounded border border-slate-700 px-3 py-2 text-xs text-slate-300 hover:bg-slate-800" (click)="removeEnvironmentEntry(i)">
          Entfernen
        </button>
      </div>
      <p *ngIf="environmentEntries().length === 0" class="text-xs text-slate-500">Keine zusätzlichen Umgebungsvariablen gesetzt.</p>
    </div>
  </div>
</div>
